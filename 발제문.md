# # 오프닝

안녕하십니까 00 번째 발표자 박기성입니다. ㅎㅎ
(오늘을 계절학기 마지막으로, 
지난 4일간의 학습내용을 공유하는 목적으로 발표를 진행하는데요..
떨리지만 최선을 다해 진행해보겠습니다.ㅎㅎ)

오늘 저의 발표주제는 'Open CV로 뭘 할 수 있는가' 입니다.
제가 이런 발표주제를 잡게된데에는 화요일날 얼굴인식 과제를 통해서 손흥민 선수의 얼굴을 인식하고 찾는 과제에 재미를 느꼈기 때문인데요. 

 다들 화요일에 진행된 얼굴인식 과제 어떠셨나요??? 저는 과제를 시작하기 전에는 **얼굴인식**이라는 이름에서부터 뭔가 어렵고, 복잡하다는 생각이 들었는데요. 하지만  또 막상 하고나니 코드도 간결하고 크게 어렵지 않게 느꼈던것 같습니다.

그래서 이후에 얼굴인식이 이렇게 쉽다고? 하는 마음으로 
''**추가로 조금 더 공부해보고자**" 했지만,
 또 조금만 깊이 들어가려하니 얼굴 검출, 특징점 검출이니, 정규화 과정등 난해하기 그지없었습니다.ㅠㅠ 

그래서 저는 바로 얼굴인식으로 들어가기 보다 이 복잡한 과정을 코드 몇줄로 가능하게 해준 Open cv라는 라이브러리가   뭔지,   (쉼표)
 또 어떻게 활용가능하지에 대해 이야기 해 보려고 합니다.ㅎㅎㅎ



# 목차

발표의 목자는 먼저 open cv가 뭔가요,   그래서 뭘 할 수 잇나요?   뭘 공부했나요?, Q&A 순으로 진행하겠습니다.



# Open CV가 뭔가요

먼저 open cv가 뭔지에 대해 말씀드리겠습니다. 이전에 인공지능이나, open cv를 공부해보신 분은 잘 아실것 같은데요.
 open cv는 컴퓨터 비전, **즉 컴퓨터의 눈** 역할로 다양한 사진이나 동영상 처리를 쉽게 할 수 있도록 도와주는 오픈소스 라이브러리입니다. 

컴퓨터 학습, 알고리즘, 수학 연산, 비디오 캡처, 이미지 처리 등과 같은 다양한 목적을 위해 제작되었으며, 

또, 성능과 속도면에서 뛰어난 정확도를 가진  2500 개 이상의 최적화  알고리즘이 포함되어 있다고 하네요. 덕분에 저희는 최적화 알고리즘을 생각하지 않고도 품질 좋은 상용 프로그램을 만들 수 있다고 합니다.

# 그래서 뭘 할 수 있나요?

그래서 이걸로 뭘 할 수 있냐 물으신다면,  

open cv는 문서를 인식하여 텍스트와  데이터를 추출하는데에 돕고 

얼굴을 감지 및 인식을 가능하게 하며 

물체의 3D 모델을 추출, 결합하여 고해상도를 생성할수 있습니다.

마지막으로 물체를 식별하고, 비디오에서 움직이는 물체를 추적하는 등 다양한 방면에서 활용가능합니다.



# 그래서 뭘 공부했나요?

그래서 저는 open cv 공부 시작하며, 입문과정에서 흔히 등장하는 색상검출을 먼저 공부했습니다. 이때, 저는 우리가 흔히 아는 rgb값이 아닌
색상, 채도, 명도값을 가진 hsv값을 가지고 특정색을 분류해 낼 수 있다는걸 배웠으며 이를 어떻게 써먹을 수 있을까라고 고민했습니다. 



# 주제선정

고민을 하던 저는 영상속에서 같은 색을 계속 찾아 쫓다보면,                   
그것도 나름의 객체 추적이 아닌가라는 생각을 했습니다. 

물론 mean-shift라는 뛰어난 성능의 객체 추적 알고리즘이 존재한다는건 알았지만 제가 배운 지식을 활용해 알고리즘을 만들어 본다면 그것 나름대로 공부가 될것이라 생각했습니다.

그리하여 저는 이 아이디어를 효율적으로 활용할 수 있는분야가 당구라고 생각햇습니다. 이미 축구, 야구 등의 스포츠에서 비디오 판독 시스템이 이용되고 있으며, 서로 다른 색상의 공으로 진행되는 당구는 색깔로 객체를 추적하겠다는 제 아이디어를 펼치기에 좋은 환경이라고 생각했기에  

저는  당구 게임 판독 시스템을 만들어봐야겠다라고 생각했습니다. 



# 시스템 설계

시스템은 다음과 같이 4가지 단계로 구성되어 진행되었습니다. 먼저 제가 필요한 영역만을 추출하는 관심영역 설정,

hsv 색공간에서 내가 찾고자 하는 색깔을 뽑아내는 색 검출작업



다음으로 컨투어를 이용한 객체 검출

여기서 **컨투어**라는 생소한 단어가 나오는데요.
컨투어는 영상속에서 **같은 밝기의 연속된 점을 찾아주는 메소드**로 open cv에서 제공되는 메소드입니다. 저는 앞서 검출한 색상의 객체의 좌표값을 찾는데 사용했습니다. 



마지막으로 객체 거리 비교를 이용한 충돌 검사입니다.



# 개발 

가장 먼저 한 작업은 관심영역만을 찾아내는 작업입니다. 
작업의 효율을 높이고자, 제게 필요한 당구대 영역만큼을 찾아내는 작업을 진행했습니다.

---

다음으로는 특정색 검출입니다. 당구대 위에서 제가 관심있는 당구공의 색인 노랑색, 빨간색, 흰색을 찾는 필터를 만드고 영상에 필터를 씌우는 작업을 진행했습니다.

결과는 다음과 같으며 오른쪽 위부터 시계방향으로 노랑색, 빨간색, 흰색 공을 검출한 모습을 볼 수 있브니다.

이후엔 앞서 말씀드렸던 같은 밝기의 연속된 점을 찾아주는 메소드 컨투어를 이용하여 각각의 좌표값을 찾습니다. 

---

소스는 다음과 같으며 좌표값을 찾아 각각의 공의 원을 그려주는 작업을 진행했습니다. 

---

또한 앞서 찾은 좌표값을 데크 자료구조에 넣어 공의 이동 경로를 그려주는 작업과

---

 두 좌표값이 일정거리 이하로 좁혀지면 충돌로 판단하는 로직도 추가해봤습니다.



# 시연영상

이렇게 해서 완성된 시연 영상을 잠시 시청하시겠습니다. 



프로젝트를 진행하면서 2가지의 문제에 부딛혔습니다. 단순히 색상만으로 객체를 쫓다보니
당구대위에 목표 색상이 들어오게 된다면 어떤게 공인지 구분하기 어려웠습니다.

또한 프레임마다 많은 연산이 진행되다 보니 동영상 속도가 많이 저하되는 현상이 발생했습니다.

이러한 점을 참고하여 앞으로는 그냥 mean-shift 라이브러리를 불러쓰는걸 추천드립니다. ㅎㅎㅎ



이상으로 발표를 마치며 제 발표를 통해서 여러분들이 opencv는 이런거고 이런것들이 가능하구나, 난 이런걸 해봐야지 하는 생각이 드셨으면 좋겠습니다. 경청해 주셔서 감사합니다. 



